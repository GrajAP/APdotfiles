{
    "layer": "top", // Waybar at top layer
    "position": "left", // Waybar position (top|bottom|left|right)
    //"height": 30, // Waybar height (to be removed for auto height)
    "width": 64, // Waybar width
    "spacing": 7, // Gaps between modules (4px)
    // Choose the order of the modules
    "margin": "0,0,0,0",
    "fixed0center": "false",
    "exclusive": "true",
    "modules-left": [
    	"hyprland/workspaces", 
    	"custom/lock", 
    	"custom/backligth"
    ],
    "modules-center": [
    	//"hyprland/window", 
    	"custom/weather", 
    	"clock"
    ],
    "modules-right": [
    	 "pulseaudio", 
	 "network", 
	 "custom/power"
    ],
    // Modules configuration
     "hyprland/workspaces": {
         "disable-scroll": true,
         "all-outputs": true,
         "warp-on-scroll": false,
         "format":  "{icon}",
         "format-icons": {
             "1": "",
             "2": "󰈹",
             "3": "",
             "4": "󰓇",
             "5": "",

         },
         "persistent-workspaces" : {
            "*" : 5
          }

     },
       "clock": {
        "timezone": "Europe/Warsaw",
	"on-click": "xdg-open https://calendar.google.com/calendar/",
	"format": "{:%H %M}",
        "tooltip-format": "<big>{:%Y %B}</big>
            <tt><small>{calendar}</small></tt>",
          },
       "custom/backlight": {
	"device": "acpi_video1",
        "format": "{percent}% {icon}",
        "format-icons": ["", "", "", "", "", "", "", "", ""]
    },
    "network": {
        // "interface": "wlp2*", // (Optional) To force the use of this interface
        "format-wifi": "({signalStrength}%) ",
        "format-ethernet": "󰈀",
        "tooltip-format": "{ifname} via {gwaddr} ",
        "format-linked": "{ifname} (No IP) ",
        "format-disconnected": "Disconnected ⚠",
        "on-click": "killall nm-connection-editor || nm-connection-editor"
    },
    "pulseaudio": {
        "scroll-step": 5, // %, can be a float
        "format": "{icon}",
        "format-muted": " ",
        "format-source": "{volume}% ",
        "format-source-muted": "",
        "format-icons": {
            "headphone": "",
            "default": ["", "", ""]
        },
        "on-click": "killall pavucontrol || pavucontrol"
    },
    "custom/lock" : 
    {
        "tooltip-format" : "",
        "on-click" : "sh -c '(sleep 0.5s; gtklock)' & disown",
        "format" : ""
    },
    "custom/power" : 
    {
        "tooltip": "false",
        "on-click": "sh -c '(shutdown)'",
	"format" : "󰐥"
    },
   }





        modules-left : [
                  "custom/crypto"
                   # "custom/eth"
        ]
        modules-center : [
          "custom/weather"
        ]
        modules-right : ["pulseaudio" "network" "custom/swallow" "custom/power"]
        "hyprland/workspaces" : {
          on-click : "activate"
          format : "{icon}"
          active-only : false
          format-icons : {
            "1" : "󰪃"
            "2" : "󰩾"
            "3" : "󰪁"
            "4" : "󰪂"
            "5" : "󰪇"
            "6" : "󰪆"
            "7" : "󰩽"
            "8" : "󰩿"
            "9" : "󰪄"
            "10" : "󰪈"
          }

        
       
        "custom/weather" : let
          weather : pkgs.stdenv.mkDerivation {
            name : "waybar-wttr"
            buildInputs : [
              (pkgs.python39.withPackages
                (pythonPackages: with pythonPackages [requests pyquery]))
            ]
            unpackPhase : "true"
            installPhase : ''
              mkdir -p $out/bin
              cp ${./weather.py} $out/bin/weather
              chmod +x $out/bin/weather
            ''
          }
        in {
          format : "{}"
          tooltip : true
          interval : 30
          exec : "${weather}/bin/weather"
          return-type : "json"
        }
        "custom/crypto" : let
          crypto : pkgs.stdenv.mkDerivation {
            name : "waybar-wttr"
            buildInputs : [
              (pkgs.python39.withPackages
                (pythonPackages: with pythonPackages [requests]))
            ]
            unpackPhase : "true"
            installPhase : ''
              mkdir -p $out/bin
              cp ${./crypto.py} $out/bin/crypto
              chmod +x $out/bin/crypto
            ''
          }
        in {
          format : "{}"
          tooltip : true
          interval : 30
          exec : "${crypto}/bin/crypto"
          return-type : "json"
        }
        "custom/vpn" : {
          format : " VPN {}"
          tooltip : true
          interval : 1
          exec : "${lib.getBin mullvad-status}/mullvad-status"
        }
        "custom/lock" : {
          "tooltip" : "false"
          "on-click" : "sh -c '(sleep 0.5s gtklock/bin/gtklock)' & disown"
          "format" : ""
        }
        "custom/swallow" : {
          tooltip : false
          on-click : let
            hyprctl : config.wayland.windowManager.hyprland.package + "/bin/hyprctl"
            notify-send : pkgs.libnotify + "/bin/notify-send"
            rg : pkgs.ripgrep + "/bin/rg"
          in
            pkgs.writeShellScript "waybar-swallow" ''
              #!/bin/sh
              if ${hyprctl} getoption misc:enable_swallow | ${rg}/bin/rg -q "int: 1" then
              	${hyprctl} keyword misc:enable_swallow false >/dev/null &&
              		${notify-send} "Hyprland" "Turned off swallowing"
              else
              	${hyprctl} keyword misc:enable_swallow true >/dev/null &&
              		${notify-send} "Hyprland" "Turned on swallowing"
              fi
            ''
          format : "󰘻"
        }
        "custom/power" : {
          "tooltip": "false",
          # TODO
          "format" : "󰐥"
        },
        clock : {
          format : ''
            {:%H
            %M}''
          tooltip-format : ''
            <big>{:%Y %B}</big>
            <tt><small>{calendar}</small></tt>''
	
        }
        backlight : {
          format : "{icon}"
          format-icons : ["" "" "" "" "" "" "" "" ""]
        }
        cpu : {
          interval : 5
          format : "  {}%"
        }
        battery : {
          states : {
            warning : 30
            critical : 15
          }
          format : "{icon} {capacity}%"
          format-charging : ""
          format-plugged : ""
          format-alt : "{icon} {capacity}%"
          format-icons : ["" "" "" "" "" "" "" "" "" "" "" ""]
        }
        network : let
          nm-editor : "${pkgs.networkmanagerapplet}/bin/nm-connection-editor"
        in {
          format-wifi : "󰤨"
          format-ethernet : "󰈀"
          format-alt : "󱛇"
          format-disconnected : "󰤭"
          tooltip-format : "{ipaddr}/{ifname} via {gwaddr} ({signalStrength}%)"
          on-click-right : "${nm-editor}"
        }
        pulseaudio : {
          scroll-step : 5
          tooltip : true
          tooltip-format : "{volume}"
          on-click : "${pkgs.killall}/bin/killall pavucontrol || ${pkgs.pavucontrol}/bin/pavucontrol"
          format : "{icon}"
          format-muted : "󰝟 "
          format-icons : {
            default : ["" "" " "]
          }
        }
      }
    }
  }
}
